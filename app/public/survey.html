<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Study Buddy - Survey</title>

    <!-- STYLESHEETS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Mansalva|Lato:400,800&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
    <div class="container text-center survey-header">
        <h2 class="survey-heading">Tell Us More About Yourself!</h2>
        <h4 class="instructions"></h4>
    </div>

    <hr>

    <div class="container text-center">
        <form>
            <div class="form-group">
                <label for="name"><span class="required">*</span> Name</label><br>
                <input type="text" class="text-input" id="name">
            </div>
            <div class="form-group">
                <label for="name"><span class="required">*</span> Link to Profile Picture</label><br>
                <input type="text" class="text-input" id="photo">
            </div>
        </form>
    </div>

    <hr>

    <div class="container questions-div">
        <form>
            <div class="form-group">
                <p class="question-heading"><span class="count">1 </span> Question</p>
                <p class="question">My mind is always buzzing with unexplored ideas and plans.</p>
                <select class="form-control q-answer" id="q1">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">2 </span> Question</p>
                <p class="question">I usually complete homework or projects right before they are due.</p>
                <select class="form-control q-answer" id="q2">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">3 </span> Question</p>
                <p class="question">I like to be organized and prepared for upcoming classes.</p>
                <select class="form-control q-answer" id="q3">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">4 </span> Question</p>
                <p class="question">I find it easy to stay relaxed and focused even when there is some pressure.</p>
                <select class="form-control q-answer" id="q4">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">5 </span> Question</p>
                <p class="question">In a discussion, I prefer to listen to other people's ideas and opinions before I share mine.</p>
                <select class="form-control q-answer" id="q5">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">6 </span> Question</p>
                <p class="question">I like to study at home.</p>
                <select class="form-control q-answer" id="q6">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">7 </span> Question</p>
                <p class="question">Music or background noise bothers me when learning.</p>
                <select class="form-control q-answer" id="q7">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">8 </span> Question</p>
                <p class="question">I enjoy food and drinks while working on my homework.</p>
                <select class="form-control q-answer" id="q8">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">9 </span> Question</p>
                <p class="question">Taking notes helps me remember study material.</p>
                <select class="form-control q-answer" id="q9">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <p class="question-heading"><span class="count">10 </span> Question</p>
                <p class="question">I like to practice a lot before moving on to the next topic.</p>
                <select class="form-control q-answer" id="q10">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <button type="submit" id="submit-survey" class="btn btn-lg btn-purple">Submit</button>
        </form>
    </div>

    <!-- FOOTER -->
    <div class="container">
        <footer class="text-center">
            <p>
                <a href="/api/buddies">API Buddy List</a>
                <span class="divider"> | </span>
                <a href="https://github.com/nadinejuraschek/StudyBuddy">GitHub Repo</a>
            </p>
            <p class="copyright">Â© <span id="year"></span> <a href="https://nadinejuraschek.com">Nadine Juraschek</a></p>
        </footer>
    </div>

    <!-- MODAL-->
    <div class="modal fade" id="modal-match" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Your Match</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" id="modal-body">

            </div>
          </div>
        </div>
      </div>

    <!-- JAVASCRIPT, JQUERY -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script type="text/javascript">
    // current year
    const currentYear = new Date().getFullYear();
    $('#year').html(currentYear);

    // new buddy data
    var newBuddy;

    // inputs
    $("#submit-survey").on("click", function(event) {
      event.preventDefault();
      console.log("Submit btn has been clicked.");

      // Validation
      function validate() {
        var valid = true;
        $(".form-control").each(function() {
          if ($(this).val() === "") {
            valid = false;
          };
        });
        return valid;
      };

      if (validate()) {
        newBuddy = {
          name: $("#name").val(),
          photo: $("#photo").val(),
          scores: [
            $("#q1").val(),
            $("#q2").val(),
            $("#q3").val(),
            $("#q4").val(),
            $("#q5").val(),
            $("#q6").val(),
            $("#q7").val(),
            $("#q8").val(),
            $("#q9").val(),
            $("#q10").val()
          ]
        };

        // push data to API
        $.post("/api/buddies", newBuddy, function(data) {
            // replace modal data with best match data
            const modalBody = $('#modal-body');
            for (var i=0; i<data.length; i++) {
                console.log("loop num: " + i);
                var matchName = data[i].name;
                console.log(matchName);
                var matchPhoto = data[i].photo;
                console.log(matchPhoto);
                var matchDiv = $('<div class="match text-center"><h2 id="match-name">' + matchName + '</h2><img id="match-img" src="' + matchPhoto + '" alt="Match Profile Picture"></div>');
                modalBody.append(matchDiv);
            };

            // show modal on submit button click
            $('#modal-match').modal('show');
        });
      } else {
            alert("All questions must be answered to get matched with a Study Buddy.");
      };

    });
    </script>
</body>
</html>